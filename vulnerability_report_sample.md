# 脆弱性診断手順書 (Walkthrough)

本ドキュメントは、`VulnBoard` アプリケーションで発見された重大な脆弱性を検証した際の手順を記録したものです。

## 1. セットアップ
- ローカルPython HTTPサーバーを起動: `python -m http.server 8080`
- アプリケーションURL: `http://localhost:8080/`

## 2. 格納型XSS (Stored XSS) の検証
**目的**: 悪意のあるスクリプトをデータベースに注入し、他のユーザーがコンテンツを閲覧した際に実行されることを検証する。

**手順:**
1.  **登録**: ユーザー `attacker` を作成しました。
2.  **ログイン**: `attacker` としてログインしました。
3.  **攻撃実行**: 以下のタイトルで新規スレッドを作成しました:
    ```html
    <script>document.body.style.backgroundColor='red';</script>XSS Test
    ```
4.  **結果**: スレッド一覧 (`index.html`) にリダイレクトされると即座にスクリプトが実行され、ページの背景色が赤色に変化しました。

## 3. DOMベースXSS (DOM-based XSS) の検証
**目的**: URLフラグメントを使用したクライアントサイドでのコード実行によるXSSを検証する。

**手順:**
1.  **攻撃実行**: 細工された以下のURLにアクセスしました:
    ```text
    http://localhost:8080/thread.html#<img src=x onerror=document.body.style.backgroundColor='blue'>
    ```
2.  **結果**: アプリケーションが `location.hash` を読み取り、それを `innerHTML` に挿入したため、`onerror` ハンドラが実行され、背景色が青色に変化しました。

## 4. 認証回避と権限昇格 (Authentication Bypass & Privilege Escalation)
**目的**: クライアントサイドのストレージを操作することで、ログインを回避し、管理者権限を取得できることを検証する。

**手順:**
1.  **攻撃実行**: ブラウザのコンソールで以下のJavaScriptを実行し、セッションを偽造しました:
    ```javascript
    localStorage.setItem('vulnboard_session', JSON.stringify({
      "userId": "attacker",
      "username": "attacker",
      "isAdmin": true, 
      "loginTime": Date.now()
    }));
    ```
2.  **検証**: `/admin.html` にアクセスしました。ページが正常に読み込まれ、「VulnBoard 管理画面」と表示されました。
3.  **アクション**: 管理者機能を使用して、「XSS Test」スレッドの削除に成功しました。